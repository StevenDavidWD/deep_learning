### note-4

---

#### Page94～Page107

#### 2017年8月10日

---

#### $Hessian$ 矩阵

$Hessian$ 矩阵是目标函数在各个方向上的二阶导数所组成的矩阵，其等价于梯度的 $Jacobian$ 矩阵。

目标函数 $f(x)$ 在 $x^0$ 点处的二阶泰勒分解式如下：

$f(x)\approx f(x^0)+(x-x^0)^Tg+\frac{1}{2}(x-x^0)^TH(x-x^0)$

其中 $g$ 为梯度， $H$ 为 $x^0$ 点处的 $Hessian$ 矩阵

将我们按照梯度下降法的思路将新的点 $x^0-\epsilon g$ 带入上述的分解式，可以得到如下式子：

$$f(x^0-\epsilon g)\approx f(x^0)-\epsilon g^Tg+\frac{1}{2}\epsilon ^2g^THg$$

这个式子由三部分组成。第一部分为原函数值；第二部分为函数斜率所导致的预期改善；第三部分是函数曲率所导致的矫正。

我们希望函数的变化值尽可能的大。我们希望取最优的 $\epsilon$ 值来达到这个目标。因此我们对 $f(x^0-\epsilon g)-f(x^0)$ 关于 $\epsilon$ 求导数，并令导数为 $0$ 。则*最优的* 的 $\epsilon$ 值为：

$$\epsilon ^*=\frac{g^Tg}{g^THg}$$

其中，对于 $g^THg$ 而言。当 $g$ 为实对称矩阵 $H$ 的一个特征向量时，$g^THg$ 为其所对应的特征值；当 $g$ 不为实对称矩阵 $H$ 的一个特征向量时，$g^THg$ 为所有特征值的加权平均。

#### $Hessian$ 矩阵与二阶导数测试

在多维函数的情形下，我们可以利用 $Hessian$ 矩阵来进行二阶导数测试，利用矩阵的特征值来判断极值点。由矩阵特征值定义可知，$d^THd$ 为方向向量 $d$ 的对应的方向二阶导数。

当 $Hessian$ 矩阵正定时，各方向上的方向二阶导数均为正；

当 $Hessian$ 矩阵负定时，各方向上的方向二阶导数均为负；

当 $Hessian$ 矩阵特征值有正有负时，各方向上的方向二阶导数正负不一。

#### 一阶优化算法与二阶优化算法

当使用一阶优化算法，如梯度下降法时，算法本身并没有考虑到函数曲率，只是单纯的选择梯度下降的最大方向，并不考虑是否之后此方向上梯度的变化情况；

二阶优化算法，如牛顿法，综合考虑了当前方向梯度与该方向上梯度的变化情况，但计算比较复杂，牵涉到矩阵求逆，且只能用在 $Hessian$ 矩阵为正定情况下，优化下降方向；

#### $Lipschitz$ 连续

深度学习背景下，我们限制函数或者其导数 $Lipschitz$ 连续：

$$\forall x, \forall y, |f(x)-f(y)|\leq\mathcal{L}||x-y||_2$$

即任意两点之间的斜率小于 $\mathcal{L}$ 

#### KKT方法

KKT方法是解决非线性约束优化问题的常用办法，其做法是构造广义 $Lagrange$ 函数，然后针对广义 $Lagrange$ 函数建立优化目标函数。

首先我们定义等式和不等式的形式约束 $\mathbb{S}$ :

$$\mathbb{S}=\{x|\forall{i},g^{(i)}=0\ and\ \forall{j},h^{(j)}\leq0\}$$

其中，$g^{(i)}$ 为等式约束，$h^{(j)}$ 为不等式约束

广义 $Lagrange$ 函数定义如下：

$$L(x,\lambda,\alpha)=f(x)+\sum_{i}\lambda_{i}g^{(i)}(x)+\sum_{j}\alpha_{j}h^{(j)}(x)$$

此时，优化目标函数如下：

$$\min_{x}\max_{\lambda}\max_{\alpha,\alpha\geq0}L(x,\lambda,\alpha)$$

由约束条件性质可知，当 $x\in \mathbb{S}$ 时，$g^{(i)}=0$ 且 $h^{(j)}\leq0$，则针对 $Lagrange$ 因子 $\lambda$ 与 $\alpha$ 的约束项均为最大值约束。当至少存在一个可行点满足约束，且令 $f(x)$ 不为 $\infty$ ，这样就可以保证上述优化目标函数与

$$\min_{x\in\mathbb{S}}f(x)$$

有相同的最优点集 

#### KKT条件

我们可以使用一组简单的性质来描述约束优化问题的最优点。KKT条件是确定一个点是最优点的必要条件，但不一定是充分条件。

KKT条件：

+ 广义 $Lagrange$ 函数的梯度为 $0$

+ 所有关于 $x$ 和KKT乘子的约束都满足

+ 不等式约束显示的‘‘互补松弛性“：$\alpha \odot h(x)=0$

   